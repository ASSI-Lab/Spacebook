<!DOCTYPE html>
<html lang="it">
<head>
	<meta charset="UTF-8">
   	<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
	<title> Gestione sito - Spacebook </title>
	<%= csrf_meta_tags %>
	<%= csp_meta_tag %>
	<%= stylesheet_link_tag 'management', media: 'all', 'data-turbolinks-track': 'reload' %>
	<%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>

	<script>
		$(document).ready(function() {
			$('#datatablesDipartimenti').DataTable();
			$('#datatablesUtenti').DataTable();
			$('#datatablesPrenotazioni').DataTable();
		} );
	</script>

</head>


<body>
<div class="sb-nav-fixed">
	<div id="layoutSidenav_content">
		<main>
			<div class="container-fluid px-4">
				<div class="card mb-4">
					<div class="card-header">
						<i class="fas fa-table me-1"></i>
						Dipartimenti
					</div>
					<div class="card-body">
						<table id="datatablesDipartimenti" class="table table-responsive table-striped table-bordered table-hover">
							<thead>
								<tr>
									<th> Nome </th>
									<th> Email del manager </th>
									<th> Indirizzo </th>
									<th> Numero di piani </th> 
									<th> Numero di spazi </th>
									<th> Grandezza degli slot prenotabili </th>
									<th> Opzioni </th>
								</tr>
							</thead>
							<tbody>
								<% @departments.each do |department| %>
								<tr>
									<td><%= department.name %></td>
									<td><%= department.manager %></td>
									<td><%= department.via %>, <%= department.civico %>, <%= department.cap %>, <%= department.citta %>, <%= department.provincia %></td>
									<td><%= department.floors %></td>
									<td><%= department.number_of_spaces %></td>
									<td><%= department.slot %>h</td>
									<td>
									<%= button_to 'Elimina', department, method: :delete, data: { confirm: 'Are you sure?'}, :class => "btnElimina" %>
									<%= button_to 'Mostra', department, method: :get, :class => "btnMostra" %>
									</td>
								</tr>
								<% end %>
							</tbody>
						</table>
					</div>
				</div>

				<div class="row">
					<div class="col-xl-4">
						<div class="card mb-4">
							<div class="card-header">
								<i class="fas fa-chart-area me-1"></i>
								Utenti
							</div>
							<div class="card-body">
								<table id="datatablesUtenti" class="table table-responsive table-striped table-bordered table-hover">
									<thead>
										<th> Email </th>
										<th> Ruolo </th>
										<th> Opzioni </th>
									</thead>
									<tbody>
										<% @users.each do |user| %>
											<tr>
												<td><%= user.email %></td>
												<td><%= user.roles %></td>
												<td> <button class="btnSospendi"> Sospendi </button> </td>
											</tr>
										<% end %>
									</tbody>
								</table>
							</div>
						</div>
					</div>
					<div class="col-xl-8">
						<div class="card mb-4">
							<div class="card-header">
								<i class="fas fa-chart-bar me-1"></i>
								Prenotazioni
							</div>
							<div class="card-body">
								<table id="datatablesPrenotazioni" class="table table-responsive table-striped table-bordered table-hover">
									<thead>
										<tr>
											<th> Utente </th>
											<th> Dipartimento </th>
											<th> Tipologia </th>
											<th> Spazio </th>
											<th> Piano </th>
											<th> Posto </th>
											<th> Stato </th>
											<th> Opzioni </th>
										</tr>
									</thead>
									<tbody>
										<% @reservations.each do |reservation| %>
											<tr>
												<td><%= reservation.email %></td>
												<td><%= reservation.dep_name %></td>
												<td><%= reservation.typology %></td>
												<td><%= reservation.space_name %></td>
												<td><%= reservation.floor %></td>
												<td><%= reservation.seat_num %></td>
												<td><%= reservation.state %></td>
												<td><%= button_to 'Destroy', reservation, method: :delete, data: { confirm: 'Are you sure?' }, :class => "btnDestroy" %></td>
											</tr>
										<% end %>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</main>
	</div>

</body>
</html>