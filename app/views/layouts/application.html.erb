<!DOCTYPE html>
<html>
  <head>
    <title>Spacebook</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <% if user_signed_in? %><!-- CONTROLLA SE L'UTENTE HA EFFETTUATO IL LOGIN -->
    <% if current_user.is_manager? and !current_page?('/make_department') and (Department.where(manager: current_user.email).count == 0) %><!-- CONTROLLA SE L'UTENTE E' MANAGER E SE HA CREATO UN DIPARTIMENTO -->
      <% require_department %>     <!-- IMPONE LA CREAZIONE DEL DIPARTIEMNTO (FUNZIONE CONTENUTA IN application_controller ) -->
    <% end %>
  <% else %>
    Non hai ancora eseguito l'accesso o la registrazione<br>
  <% end %>


    <button onclick="window.location.href='/home'" style="width:80%"><h2>SPACEBOOK</h2></button>

    <% if !user_signed_in? %>
      <button onclick="window.location.href='/users/sign_in'" style="width:9%">Accedi</button>
      <button onclick="window.location.href='/users/sign_up'" style="width:10%">Registrazione</button>
    <% else %>
      <button onclick="window.location.href='/personal_area'" style="width:10%">Area personale</button>  
      <% if current_user.roles in ["admin"] %>
        <button onclick="window.location.href='/management'" style="width:9%">Gestione sito</button>
      <% end %>
    <% end %>

  <p class="notice"><%= notice %></p>
  <p class="alert"><%= alert %></p>

  <body>
    <%= yield %>
  </body>

  <br>
  <br>

  <table width="100%">
    <td>
      <button onclick="window.location.href='/informations'">Informazioni</button>
      <% if user_signed_in? %>
        Hai fatto l'accesso come: [ <%= current_user.email %> ]
      <% end %>
    </td>
    <td style="text-align:center">
      <% if user_signed_in? %>
        <%= button_to 'Esci', destroy_user_session_path, :method => :delete %>
      <% end %>
    </td>
  </table>

</html>
